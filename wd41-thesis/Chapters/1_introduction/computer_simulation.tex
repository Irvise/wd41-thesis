%************************************************************************************************************
\section{Computer Simulation and Safety Analysis of Nuclear Power Plant}\label{sec:intro_computer_simulation}
%************************************************************************************************************

%------------------------------------------------------------------------------------------
\subsection{Scientific Computer Simulation}\label{sub:intro_scientific_computer_simulation}
%------------------------------------------------------------------------------------------

% A definition
The ubiquity of computer simulation applications in many fields of science and engineering results in an even more pervasive definitions of the term \textit{scientific computer simulation} itself and other associated terms such as \textit{model} and \textit{simulation}.
\marginpar{scientific computer simulation}
Though most of the definitions in the literature are not necessarily in contradiction to each other, 
to avoid confusion, this thesis adopts a recent definition proposed by Kaizer et al.\cite{Kaizer2015} quoted below,
\begin{quote}
	Scientific Computer Simulation is the imitation of a behavior of a system, entity, phenomenon, or process in the physical universe 
	using limited mathematical concepts, symbols, and relations through the exercise or use of scientific computer model.
\end{quote}

% The definition, explained
This definition highlights three main points.
\marginpar{model, simulation, scientific simulation, and scientific computer simulation}
First, this definition accentuates the difference between a \emph{model} and its \emph{simulation}.
Specifically, the former deals with the notion of representation, while the latter deals with the notion of imitation of a behavior.
Secondly, what makes a model scientific is that it treats physical phenomena, process, or the behavior of a real world system as its subject.
The model itself is then referred to as physical model\footnote{Note that this term is referring to the mathematical model of a physical process, and \emph{not} a physical copy of object of interest (vis-Ã -vis conceptual model). As of October $31$, $2017$ the entry ``physical model'' in Wikipedia refers to the latter.} .
Thirdly and finally, the modifier \emph{computer} in the definition makes it explicit that digital computer is used to solve whatever mathematical models serve as the representation.
This is usually the case for mathematical models that cannot be solved analytically.
Though this limitation what makes a solution of the model possible in the first place, 
it also affects the solution and its possible interpretation and thus many computational-related aspects also often need to be comprehensively considered.

% A distinction by Beven
Beven \cite{Beven2009} articulates this distinction into three levels of a scientific model: perceptual model (i.e., theoretical description of some physical phenomena),
formal model (i.e., the mathematical description of it),
and procedural model (i.e., computer implementation of the formal model).
For many complex physical system modeling applications, only the procedural model is able to make a quantitative prediction of the system.
Thus, these distinctions are useful in acknowledging the level of approximation involved in moving from perceptual to procedural model.

% Code
A computer software that implements scientific models down to the solution algorithms for a particular (field-specific) application is called \emph{scientific code} or simply \emph{code} \cite{Trucano2006}.
\marginpar{Code}
Many modern implementation of scientific codes, apart from being possibly field-specific, are designed to be a comprehensive platform which allows for flexibility in modeling various systems ranging from the specifications of geometry, the initial and boundary conditions, and design variables to the settings for discretization scheme and numerical solver.
Examples of such software are multi-physics simulation platforms, computational fluid dynamics codes, and \gls[hyper=false]{th} system codes.

% Simulator
A \emph{simulation} or a \emph{calculation} \cite{Trucano2006} using a code can only be made on a particular well-specified system, where all the aforementioned attributes (geometry, initial and boundary conditions, etc.) have been completely fixed or specified.
\marginpar{Simulator}
As a result, the term \emph{simulator} includes not only the code itself, but also to the particular system of interest being modeled using the code \cite{OHagan2006}.

%-------------------------------------------------------------------------------------------------------------------------------------------
\subsection[Deterministic Safety Analysis of Nuclear Power Plant]{Deterministic Safety Analysis of Nuclear Power Plant}\label{sub:intro_dsa}
%-------------------------------------------------------------------------------------------------------------------------------------------

% Goal of simulation and entry to safety analysis
Scientific codes play a central role in the deterministic safety analysis of an \gls[hyper=false]{npp}.

% Entry to Thermal-Hydraulics Code
As noted in \cite{DAuria2012}

% Conservative Analysis
During the early days of reactor safety analysis, prediction using computer model of \gls[hyper=false]{npp} behavior during transient, off-normal or accident conditions, was approached with high-degree of conservatism.
\marginpar{Conservative analysis}
Conservatism called for the most penalizing modeling assumptions to ensure conservative results, which is far below their regulatory limits.
This approach, though less realistic, was justified by limited modeling capabilities as well as limited knowledge of the physical process involved during those transients.
However, it was later found that there are conditions where conservative assumptions do not necessarily lead to conservative (or even physical) predictions.

% An Illustration
As an example of this contradiction, consider the following situation in the analysis of \gls[hyper=false]{loca} as described in \cite{IAEA2009}.
\marginpar{An illustration}
Assuming less interfacial shear between liquid and gas phase of the coolant (water) reducing mist flow during \gls[hyper=false]{loca} is conservative in the sense that less heat will be transferred to the coolant flow in the upper region of the core.
This, in turn, penalizes the fuel temperature prediction.
But this assumption also implies that the time to refill the core is shorter as there will be more liquid retained in the reactor cooling system.
Furthermore, with less shear, there is less resistance in injecting emergency coolant into the core (condition known as the counter-current flow limitation).
Both of these are clearly non-conservative and contradicting the initial conservative assumption.

% Best-estimate Analysis
Therefore, a more accurate prediction of two-phase flow transient behavior was deemed necessary for the safety analysis of nuclear power plant under accident conditions.
\marginpar{Best-estimate analysis}
As opposed to the conservative analysis, the term for this approach was coined \emph{best-estimate} analysis.
Such an analysis calls for more physically sound thermal-hydraulics models with more realistic modeling assumptions which at the same time are also backed by experimental data obtained from numerous experimental programs conducted in Separate and Integral Effect Test Facilities.
With the idea of having more realistic prediction in mind, a best-estimate \gls[hyper=false]{th} system code was developed.
The code is designed to be a comprehensive tool capable of simulating realistically wide range of transients foreseen in \gls[hyper=false]{npp} operation.
It was developed using the current best understanding of flow processes expected to happen during the transients.

%--------------------------------------------------------------------------------
\subsection{Thermal-Hydraulics (TH) System Codes}\label{sub:intro_th_system_code}
%--------------------------------------------------------------------------------

% Thermal-Hydraulics System Code, what and why
A \gls[hyper=false]{th} system code is a tool to simulate the flow behavior in the reactor coolant system of an entire \gls[hyper=false]{npp} during wide range of transients foreseen in its operation.
\marginpar{TH system code}
This implies solving time-dependent conservation equations describing the two-phase fluid flow inside the coolant circuit coupled with a heat conduction equation in solid, describing the heat transfer between fluid and heated elements (e.g., fuel rods).
The simulation of the plant behavior also requires an explicit modeling of the geometry, components, equipments, and systems that are specific to \glspl[hyper=false]{npp} \cite{DAuria2012}.  

% Nodalization
The coolant circuit of a \gls[hyper=false]{npp} is a complex system.
This includes the reactor pressure vessel and all its intricate contents; kilometers of interconnecting pipes; scores of valves, pumps, and tanks; as well as numerous special components from steam generator to condenser.
\marginpar{Nodalization}
The first major simplification taken for describing the fluid flow in the coolant circuit is by $1$-dimensional \emph{nodalization}.
Through nodalization, a \gls[hyper=false]{npp} is decomposed into a set of interconnected \emph{nodes} which holds discretized information of fluid flow (see Fig.~\ref{fig:ch1_nodalization}).
As a result, a node becomes the primitive data structure in system code.
Due to the $1$-dimensional simplification of the flow\footnote{some system codes allows a $3$-dimensional modeling for \emph{selected} components, mainly the reactor pressure vessel where $3$-dimensional effects might be of relevance to safety analysis. However, as of today, no system code supports full $3$-dimensional modeling of all the components in the coolan circuit.}, a node is only characterized by its \emph{fluid cell} (with attributes of length and free volume) and its \emph{faces} (with attributes of flow area, hydraulic diameter, and orientation). 
\begin{figure}[bth]	
	\centering
	\includegraphics[width=\textwidth]{../figures/chapter1/figures/nodalization}
	\caption[Nodalization of a nuclear power plant (NPP) in a thermal-hydraulics (TH) system code]{Nodalization of an \gls[hyper=false]{npp} in a \glsfirst[hyper=false]{th} system code. Shaded elements are heated elements, where heat exchange occurs between the element and the fluid.}
	\label{fig:ch1_nodalization}
\end{figure}

% Structure of a system code
The typical structure of a system code is illustrated in Fig.~\ref{fig:ch1_th_system_code}.
As can be seen, system code constitutes of several building blocks that can be used to model and simulate wide range of system and conditions.
\marginpar{Structure of thermal-hydraulics system codes}
It includes a set of conservation equations, closure laws, and equation of states.
System codes are complemented with models for special components that performs specific function (e.g., solid heated structure, pumps, and separators) or actions during transient (e.g., valves, instrumentation, and control systems);
and models for special processes and phenomena that are relevant to the conditions of \glspl[hyper=false]{npp} but too complex to model implicitly in the (simplified) conservation equations (e.g., critical flow).
In fact, the inclusion of models for those components and processes relevant to the conditions of \glspl[hyper=false]{npp} are the defining characteristics of \gls[hyper=false]{th} system code \cite{DAuria2012}.   
\begin{figure}[!bth]	
	\centering
	\includegraphics[width=\textwidth]{../figures/chapter1/figures/th_system_code}
	\caption[Generic structure of a thermal-hydraulics (TH) system code]{Generic structure of a \glsfirst[hyper=false]{th} system code. The code and a system specified by the input deck define a \emph{simulator} of that system.}
	\label{fig:ch1_th_system_code}
\end{figure}

% Constitutive Equations
The core element of system code is a set of conservation equations describing the dynamics of the state variables of the fluid.
To close the system of equations (i.e., to have the same number of equations as the number of unknowns), it has to be complemented by two additional set of constitutive equations.
The first is the equation of state describing the thermodynamic relation between state variables of a given fluid.
The second is the closure relationships describing the interaction between phases and each phase to the boundary wall in terms of mass, momentum, and energy. 

% Two-fluid Model
The state-of-the-art model widely implemented in \gls[hyper=false]{th} system codes to describe the dynamics of fluid flow in \glspl[hyper=false]{npp} (specifically, \gls[hyper=false]{lwr}) is based on the two-fluid model.
\marginpar{Two-fluid model}
This model separately treats the transport phenomena of the two-phases of fluid flow (gas and liquid) resulting in a set of six balance equations (mass, momentum, and energy for each of the two phases).
The model can capture phenomena where thermal and mechanical non-equilibrium conditions exist between the two phases, conditions which give more realistic picture in a wide range of \gls[hyper=false]{npp} transients.

% Validity of Two-fluid Model
The validity of the two-fluid model widely implemented in thermal-hydraulics system codes relies on the proper modeling of the transfer terms between phases and each phase with the boundary wall.
The transfer terms include interfacial drag, interfacial heat transfer, and wall heat transfer.
In principle, based on different two-phase flow pattern, different phase distribution and different interfacial structure can be observed.
As a result, each of those transfer terms takes different form with different parameters depending on the pattern of the two-phase flow.
The transfer terms represent different physical processes taking place at each flow pattern;
in other words, constitutes the \emph{physical models} of a system code.

% Closure Laws, fully empirical
These physical models, or the so-called \emph{closure laws}, close the set of balance equations for mass, momentum, and energy of the two phases.
Based on their origin, closure laws can be classified into three categories: fully empirical, fully mechanistic, and semi-empirical \cite{Bestion2008}.
\marginpar{Closure laws origin}
Fully empirical are closure laws developed based only on the available representative experimental data by correlating transfer terms of interest with observed flow variables.
Based on their derivation, closure laws can be classified into three categories: fully empirical, fully mechanistic, and semi-empirical \cite{Bestion2008}.
\marginpar{Fully empirical approach}
Fully empirical laws are developed based only on the available representative experimental data by correlating transfer terms of interest with observed flow variables.
Given comprehensive experimental data, these models tend to be accurate within the range of experimental condition (i.e., its validation domain).
On the other hand, an extrapolation outside of that range can give dubious results.

% fully mechanistic
Fully mechanistic (i.e., \emph{phenomenological}) approach for developing closure laws lies at the other end of the spectrum.
\marginpar{Fully mechanistic approach}
Using this approach, a physical mechanism that governs the phenomena of interest is postulated.
Experimental data plays a role only in validating such a postulated model.
If the model cannot be supported by the data then a complete revision might be required.
Mechanistic approach to closure laws modeling provides a scientific basis for prediction outside the validation data (i.e., extrapolation). 
However, its quality strongly depends on the adequacy of the postulated model and the associated assumptions in the first place.

% semi-empirical approach
Lastly, the semi-empirical approach combines both of the approach in the sense that mechanistic model is initially developed based on a postulated governing mechanism.
\marginpar{Semi-empirical approach}
However, \emph{tuning} parameters are introduced that can be fitted to match the the experimental data.
As such, these parameters become a measure of the inadequacy of the postulated model in explaining the data due to any missing physical process.

% Source of uncertainty
Any of these approaches proved to be a difficult effort \cite{Barre1990,Nelson1992,Wulff2007} due to various reasons ranging from lack of knowledge of the underlying physical process (with respect to the fully mechanistic modeling) to limitation in the amount of data as well as in measurement instruments (with respect to the fully empirical approach).
Simplifying assumptions and extrapolation have to be made because of that limitations.
In the end, closure laws in system code are of mixed origins and they become a major source of uncertainty\footnote{defined in this thesis a state of limited knowledge, that is of \emph{epistemic} nature} in the application of \gls[hyper=false]{th} system codes, especially outside its validation domain.
