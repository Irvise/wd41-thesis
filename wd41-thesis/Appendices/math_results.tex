%*****************************************************************************
\chapter{Some Useful Mathematical Results and Recipes}\label{app:math_results}
%*****************************************************************************

\section{Bootstrapping}\label{app:bootstrapping}

\section{Generating Samples from a Multivariate Normal Distribution}

Drawing $n$ number of samples from an $m$-variate Normal distribution, $\boldsymbol{x} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\Sigma})$ having an arbitrary $m \times 1$ mean vector $\boldsymbol{\mu}$ and an arbitrary, but valid, $m \times m$ covariance matrix $\boldsymbol{\Sigma}$ can be achieved by using a (univariate) standard normal random number generator available in most numerical computing environment.
The procedure is as follows (citation):

\begin{enumerate}
	\item Factorize the covariance matrix $\boldsymbol{\Sigma}$ using the Cholesky decomposition,
	\begin{equation}
	\boldsymbol{\Sigma} = L L^T
	\end{equation}
	where $L$ and $L^T$ are the Cholesky factor and its transpose, respectively. $L$ is a lower triangular matrix.
	
	\item Generate vector $\mathbf{z}=(z_1, z_2, \dots, z_m)^T$ by taking $m$ random draws from a standard normal random generator, $u \sim \mathcal{N}(0, 1)$.
	
	\item Transform the vector $\mathbf{z}$ by the following formula,
	\begin{equation}
	\mathbf{x} = \boldsymbol{x} + L \boldsymbol{z}
	\end{equation}
	where the $m \times 1$ vector $\mathbf{x}$ is a single realization of the specified $m$-variate normal random variable.
	
	\item Repeat Step $2$ and Step $3$ $n$ times to obtain the desired number of samples 
\end{enumerate}

\section{Landmark Registration and Time Warping Function}\label{app:landmark}

The most straightforward curve registration procedure is the landmark registration/marker registration \cite{Ramsay2009}.
\emph{Landmarks} are salient features of a curve that can be observed or expected to occur in a set of curves.
In the context of reflood simulation, examples of such landmarks are the time of maximum temperature and the time of quenching.
A transformation of time for each curve is carried such that these features are aligned to each other with respect to a reference curve.

The landmark registration problem can be expressed as the following: 
Let $\{y_i(t); i = 1, 2, \cdots, N; t \in [t_a,t_b]\}$ be a set of continuous curves/functions defined over the domain $t_a$ to $t_b$.
Let $\{y_{ref}(t_j); j = 1, \cdots, m\}$ be a set of $m$ landmarks of a given reference function $y_ref(t)$.
Then a set of time warping functions $\{h_i(t); i = 1, 2, \cdots, N; t \in [t_a, t_b]\}$ for each curve in the data set can be defined.
These functions have the following properties:

\begin{enumerate}
	\item Each $h_i(t)$ is defined in the same domain as the domain of the original curve $y_i(t)$. That is, $t \in [t_a, t_b]$
  \item Each $h_i(t)$ satisfies the boundary conditions,
    \begin{equation}
      \begin{split}
        h_i(t_a) & = t_a \\
        h_i(t_b) & = t_b
      \end{split}
    \label{eq:warping_boundaries}
    \end{equation}
   \item Each $h_i(t)$ is a strictly increasing function 
         \begin{equation}
            h_i(t_2) > h_i(t_1) \text{for} \, t_2 > t_1
         \label{eq:warping_increasing}
         \end{equation}
         The first implication of this property is that the time transformation process cannot alter the ordering of the landmarks.
         In other words, time is strictly increasing both in original frame and transformed frame.
         The second implication is that the time warping function is an invertible function 
         such that for the same event there exists a unique pair of time and its transformed value.
    \item Each $h_i(t)$ transforms the time for each curve such that the timing of the $m$ specified landmarks are aligned with respect to the reference function,
          \begin{equation}
            \begin{split}
              y_i \circ h_i(t) & = y_i [h_i(t)] & = y^*_i(t) ; \, & i = 1, 2, \cdots, N  \\
              h_i^{-1} \circ h_i (t_j) & = t_j  & ; \, j = 1, 2, \cdots, M & 
            \end{split}
          \label{eq:warping_transformation}
          \end{equation}
          where $y_i^*$ is the \emph{registered} curve $i$, while $h_i^{-1}$, the inverse of $h_i(t)$ is the aligning function.
          If, for instance, $h_i(t_j) > t_j$ then the landmark $j$ for curve $i$ is delayed 
          and the aligning function accelerates the time for curve $i$ to conform to the reference timing.
          On the other hand, if $h_i(t_j) < t_j$ then the landmark $j$ for curve $i$ occurs earlier
          and the aligning function retards the time for curve $i$ to conform to the reference timing.
\end{enumerate}

The registration problem can then be posed an estimation problem of each time warping function $h_i(t)$ constrained by the above properties.
Following \cite{Ramsay1998}, it is solved by using penalized least square regression method.
In accordance to the \gls{fda} framework, the warping function is also represented as a linear combination of B-spline basis functions.